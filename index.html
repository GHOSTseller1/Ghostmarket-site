<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GhostMarket</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; transition: all 0.3s; }
        body { font-family: 'Arial', sans-serif; background-color: #0a0a0a; color: #e0e0e0; line-height: 1.6; }
        a { text-decoration: none; color: #00ff00; }
        ul { list-style: none; }

        header { background: linear-gradient(135deg, #1a1a1a, #333); padding: 1rem 2rem; border-bottom: 2px solid #00ff00; box-shadow: 0 2px 10px rgba(0, 255, 0, 0.2); }
        .header-container { display: flex; justify-content: space-between; align-items: center; max-width: 1200px; margin: 0 auto; }
        .logo { font-size: 2rem; font-weight: bold; color: #00ff00; text-shadow: 0 0 10px #00ff00; }
        nav ul { display: flex; gap: 2rem; }
        nav li a { padding: 0.5rem 1rem; transition: all 0.3s; border-radius: 5px; }
        nav li a:hover { background: #00ff00; color: #000; }
        .cart-icon { position: relative; font-size: 1.5rem; color: #00ff00; cursor: pointer; }
        .cart-count { position: absolute; top: -8px; right: -8px; background: #ff0000; color: white; border-radius: 50%; width: 20px; height: 20px; display: flex; align-items: center; justify-content: center; font-size: 0.8rem; }

        .hero { background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 400"><rect fill="%230a0a0a" width="1200" height="400"/><path d="M0 200 Q300 100 600 200 T1200 200" stroke="%2300ff00" stroke-width="2" fill="none" opacity="0.3"/></svg>') no-repeat center/cover; height: 400px; display: flex; align-items: center; justify-content: center; text-align: center; color: #fff; }
        .hero h1 { font-size: 3.5rem; margin-bottom: 1rem; text-shadow: 0 0 20px #00ff00; }
        .hero p { font-size: 1.2rem; opacity: 0.9; }

        .section { padding: 4rem 2rem; max-width: 1200px; margin: 0 auto; }
        .section-title { text-align: center; font-size: 2.5rem; margin-bottom: 3rem; color: #00ff00; }
        .product-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 2rem; }
        .product-card { background: #1a1a1a; border: 1px solid #333; border-radius: 10px; overflow: hidden; transition: transform 0.3s, box-shadow 0.3s; }
        .product-card:hover { transform: translateY(-5px); box-shadow: 0 10px 20px rgba(0, 255, 0, 0.3); }
        .product-image { width: 100%; height: 200px; background: linear-gradient(45deg, #333, #555); display: flex; align-items: center; justify-content: center; font-size: 4rem; color: #666; }
        .product-info { padding: 1.5rem; }
        .product-title { font-size: 1.3rem; margin-bottom: 0.5rem; color: #fff; }
        .product-price { font-size: 1.5rem; color: #00ff00; font-weight: bold; margin-bottom: 1rem; }
        .product-description { color: #aaa; margin-bottom: 1rem; font-size: 0.9rem; }
        .add-to-cart { width: 100%; padding: 0.8rem; background: #00ff00; color: #000; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; transition: background 0.3s; }
        .add-to-cart:hover { background: #00cc00; }
        .add-to-cart:disabled { background: #666; cursor: not-allowed; }
        .stock-info { color: #ff4444; font-size: 0.9rem; margin-bottom: 1rem; }

        .cart-modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.85); z-index: 1000; justify-content: center; align-items: center; }
        .cart-content { background: #1a1a1a; padding: 2rem 3rem; border-radius: 15px; width: 90%; max-width: 600px; max-height: 85vh; overflow-y: auto; border: 2px solid #00ff00; box-shadow: 0 0 15px rgba(0, 255, 0, 0.5); }
        .close-cart { position: absolute; top: 1rem; right: 1rem; font-size: 2.5rem; color: #ff0000; cursor: pointer; transition: color 0.3s; }
        .close-cart:hover { color: #cc0000; }
        .cart-title { text-align: center; font-size: 2rem; color: #00ff00; margin-bottom: 1.5rem; text-shadow: 0 0 10px #00ff00; }
        .cart-items { margin-bottom: 2rem; }
        .cart-item { display: flex; justify-content: space-between; align-items: center; padding: 1rem; background: #222; border-radius: 5px; margin-bottom: 1rem; }
        .cart-item span { font-size: 1.1rem; }
        .cart-item button { background: #ff0000; color: white; border: none; padding: 0.3rem 0.7rem; border-radius: 5px; cursor: pointer; transition: background 0.3s; }
        .cart-item button:hover { background: #cc0000; }
        .cart-total { font-size: 1.8rem; text-align: right; color: #00ff00; padding: 1rem 0; border-top: 1px solid #333; }
        .checkout-btn { width: 100%; padding: 1rem; background: #00ff00; color: #000; border: none; border-radius: 5px; font-size: 1.2rem; font-weight: bold; cursor: pointer; transition: background 0.3s; }
        .checkout-btn:hover { background: #00cc00; }
        .checkout-btn:disabled { background: #666; cursor: not-allowed; }

        .video-loop { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 9999; background: black; }
        .video-loop video { width: 100%; height: auto; max-width: 100%; max-height: 100vh; object-fit: contain; playsinline; }

        body.ghost-mode * { color: #ff0000 !important; content: "GHOST1" !important; }

        footer { background: #000; padding: 2rem; text-align: center; border-top: 2px solid #00ff00; color: #666; }

        .noscript { display: none; }
        noscript .noscript { display: block; text-align: center; padding: 2rem; color: #ff4444; }

        @media (max-width: 768px) {
            .header-container { flex-direction: column; gap: 1rem; }
            .hero h1 { font-size: 2.5rem; }
            .video-loop video { width: 100vw; height: 100vh; object-fit: cover; }
        }
    </style>
</head>
<body>
    <header>
        <div class="header-container">
            <div class="logo">GhostMarket</div>
            <nav>
                <ul>
                    <li><a href="#home" onclick="handleHomeClick(event)">Home</a></li>
                    <li><a href="#grow-garden">Grow a Garden</a></li>
                    <li><a href="#steal-brainrot">Steal a Brainrot</a></li>
                    <li><a href="#plants-vs-brainrots">Plants Vs Brainrots</a></li>
                    <li><a href="#contact">Contact</a></li>
                </ul>
            </nav>
            <div class="cart-icon" onclick="toggleCart()">Cart <span class="cart-count" id="cartCount">0</span></div>
        </div>
    </header>

    <section class="hero" id="home">
        <div>
            <h1>Welcome to GhostMarket</h1>
            <p>Grow gardens, steal brainrots. Robux deals, no limits.</p>
        </div>
    </section>

    <!-- GROW A GARDEN -->
    <section class="section" id="grow-garden">
        <h2 class="section-title">Grow a Garden Items</h2>
        <div class="product-grid">
            <div class="product-card" id="pricklefruit-card">
                <div class="product-image">Cactus</div>
                <div class="product-info">
                    <h3 class="product-title">Pricklefruit</h3>
                    <p class="product-price">75 Robux</p>
                    <p class="stock-info" id="pricklefruit-stock">Quantity Available: 30</p>
                    <p class="product-description">Rare pricklefruit seeds, each fruit is worth 100-500 billion.</p>
                    <button class="add-to-cart" id="pricklefruit-button" onclick="addToCart('Pricklefruit', 'pricklefruit')">Add to Cart</button>
                </div>
            </div>
            <div class="product-card" id="agedpet-card">
                <div class="product-image">Dog</div>
                <div class="product-info">
                    <h3 class="product-title">Aged Pet</h3>
                    <p class="product-price">100 Robux</p>
                    <p class="stock-info" id="agedpet-stock">Quantity Available: 15</p>
                    <p class="product-description">Mature companion. Age 30-50.</p>
                    <button class="add-to-cart" id="agedpet-button" onclick="addToCart('Aged Pet', 'agedpet')">Add to Cart</button>
                </div>
            </div>
        </div>
    </section>

    <!-- STEAL A BRAINROT -->
    <section class="section" id="steal-brainrot">
        <h2 class="section-title">Steal a Brainrot Items</h2>
        <div class="product-grid">
            <div class="product-card" id="tacorita-card">
                <div class="product-image">Bicycle</div>
                <div class="product-info">
                    <h3 class="product-title">Tacorita Bicicleta</h3>
                    <p class="product-price">1000 Robux</p>
                    <p class="stock-info" id="tacorita-stock">Quantity Available: 1</p>
                    <p class="product-description">50m a second. One only.</p>
                    <button class="add-to-cart" id="tacorita-button" onclick="addToCart('Tacorita Bicicleta', 'tacorita')">Add to Cart</button>
                </div>
            </div>
            <div class="product-card" id="chachechi-card">
                <div class="product-image">Snake</div>
                <div class="product-info">
                    <h3 class="product-title">Chachechi</h3>
                    <p class="product-price">355 Robux</p>
                    <p class="stock-info" id="chachechi-stock">Quantity Available: 1</p>
                    <button class="add-to-cart" id="chachechi-button" onclick="addToCart('Chachechi', 'chachechi')">Add to Cart</button>
                </div>
            </div>
            <div class="product-card" id="lacucaracha-card">
                <div class="product-image">Ladybug</div>
                <div class="product-info">
                    <h3 class="product-title">La Cucaracha</h3>
                    <p class="product-price">325 Robux</p>
                    <p class="stock-info" id="lacucaracha-stock">Quantity Available: 1</p>
                    <button class="add-to-cart" id="lacucaracha-button" onclick="addToCart('La Cucaracha', 'lacucaracha')">Add to Cart</button>
                </div>
            </div>
            <div class="product-card" id="karkersahur-card">
                <div class="product-image">Bat</div>
                <div class="product-info">
                    <h3 class="product-title">Karker Sahur</h3>
                    <p class="product-price">400 Robux</p>
                    <p class="stock-info" id="karkersahur-stock">Quantity Available: 1</p>
                    <button class="add-to-cart" id="karkersahur-button" onclick="addToCart('Karker Sahur', 'karkersahur')">Add to Cart</button>
                </div>
            </div>
        </div>
    </section>

    <!-- PLANTS VS BRAINROTS -->
    <section class="section" id="plants-vs-brainrots">
        <h2 class="section-title">Plants Vs Brainrots</h2>
        <div class="product-grid">
            <div class="product-card" id="mythicalmoneymakers-card">
                <div class="product-image">Money</div>
                <div class="product-info">
                    <h3 class="product-title">Mythical Money Makers</h3>
                    <p class="product-price">125 Robux</p>
                    <p class="stock-info" id="mythicalmoneymakers-stock">Quantity Available: 25</p>
                    <p class="product-description">1.2-3k a second. 25 available.</p>
                    <button class="add-to-cart" id="mythicalmoneymakers-button" onclick="addToCart('Mythical Money Makers', 'mythicalmoneymakers')">Add to Cart</button>
                </div>
            </div>
        </div>
    </section>

    <!-- CART MODAL -->
    <div class="cart-modal" id="cartModal">
        <div class="cart-content">
            <span class="close-cart" onclick="toggleCart()">&times;</span>
            <h2 class="cart-title">Your Cart</h2>
            <div class="cart-items" id="cartItems"></div>
            <div class="cart-total" id="cartTotal">Total: 0 Robux</div>
            <button class="checkout-btn" id="checkoutBtn" onclick="checkout()">Proceed to Checkout</button>
        </div>
    </div>

    <!-- VIDEOS -->
    <div class="video-loop" id="videoLoop">
        <video id="goatVideo" autoplay loop playsinline>
            <source src="goatVideo.mp4" type="video/mp4">
        </video>
    </div>

    <div class="video-loop" id="homeVideoLoop">
        <video id="homeVideo" autoplay loop playsinline>
            <source src="https://drive.google.com/uc?export=download&id=130fOVOJULIk3At3_ThqsiwFHfQLEo4hp" type="video/mp4">
        </video>
    </div>

    <footer id="contact">
        <p>&copy; 2025 GhostMarket. Contact: <a href="https://discord.gg/4e7kf2QQWe">Discord</a></p>
    </footer>

    <script>
        // ==== PERSISTENT STATE ====
        const homeVideoActive = sessionStorage.getItem('homeVideoActive') === 'true';
        const stockOutActive = sessionStorage.getItem('stockOutActive') === 'true';

        // ==== STOCK (FULLY RESTORED) ====
        let stock = {
            pricklefruit: 30,
            agedpet: 15,
            tacorita: 1,
            chachechi: 1,
            lacucaracha: 1,
            karkersahur: 1,
            mythicalmoneymakers: 25
        };

        let prices = { pricklefruit: 75, agedpet: 100, tacorita: 1000, chachechi: 355, lacucaracha: 325, karkersahur: 400, mythicalmoneymakers: 125 };
        let cart = [];
        let totalRobux = 0;
        let homeClickCount = 0;

        // ==== ON LOAD: RESTORE VIDEO + STOCK UI ====
        document.addEventListener('DOMContentLoaded', () => {
            document.querySelectorAll('.noscript').forEach(el => el.style.display = 'none');
            updateStockUI();

            if (homeVideoActive) triggerHomeVideo();
            if (stockOutActive) triggerStockOutVideo();
        });

        function updateStockUI() {
            Object.keys(stock).forEach(id => {
                const el = document.getElementById(`${id}-stock`);
                if (el) el.textContent = `Quantity Available: ${stock[id]}`;
                const btn = document.getElementById(`${id}-button`);
                if (btn && stock[id] <= 0) {
                    btn.disabled = true;
                    btn.textContent = 'Out of Stock';
                    btn.style.background = '#666';
                }
            });
        }

        function handleHomeClick(e) {
            e.preventDefault();
            homeClickCount++;
            if (homeClickCount === 5) {
                sessionStorage.setItem('homeVideoActive', 'true');
                triggerHomeVideo();
                homeClickCount = 0;
            }
        }

        function triggerHomeVideo() {
            const loop = document.getElementById('homeVideoLoop');
            const vid = document.getElementById('homeVideo');
            loop.style.display = 'block';
            vid.load();
            vid.play().catch(() => {});
            flashGhost();
            document.body.style.overflow = 'hidden';
        }

        function triggerStockOutVideo() {
            const loop = document.getElementById('videoLoop');
            const vid = document.getElementById('goatVideo');
            loop.style.display = 'block';
            vid.load();
            vid.play().catch(() => {});
            flashGhost();
            document.body.style.overflow = 'hidden';
        }

        function flashGhost() {
            document.body.classList.add('ghost-mode');
            setTimeout(() => document.body.classList.remove('ghost-mode'), 1000);
        }

        function addToCart(name, id) {
            if (stock[id] <= 0) return alert('Out of stock!');
            cart.push({ name, price: prices[id] });
            totalRobux += prices[id];
            stock[id]--;
            updateStockUI();
            document.getElementById('cartCount').textContent = cart.length;
            updateCartDisplay();
            checkStockOut();
        }

        function checkStockOut() {
            if (Object.values(stock).every(s => s === 0) && !stockOutActive) {
                sessionStorage.setItem('stockOutActive', 'true');
                triggerStockOutVideo();
            }
        }

        function removeFromCart(i) {
            const item = cart.splice(i, 1)[0];
            totalRobux -= item.price;
            const id = Object.keys(prices).find(k => item.name.toLowerCase().includes(k.replace(/s$/, ''))) || 'pricklefruit';
            stock[id]++;
            updateStockUI();
            document.getElementById('cartCount').textContent = cart.length;
            updateCartDisplay();
            if (sessionStorage.getItem('stockOutActive') === 'true' && !Object.values(stock).every(s => s === 0)) {
                sessionStorage.removeItem('stockOutActive');
            }
        }

        function updateCartDisplay() {
            document.getElementById('cartItems').innerHTML = cart.map((item, i) => `
                <div class="cart-item">
                    <span>${item.name} - ${item.price} Robux</span>
                    <button onclick="removeFromCart(${i})">Remove</button>
                </div>
            `).join('');
            document.getElementById('cartTotal').textContent = `Total: ${totalRobux} Robux`;
            document.getElementById('checkoutBtn').disabled = cart.length === 0;
        }

        function toggleCart() {
            const m = document.getElementById('cartModal');
            m.style.display = m.style.display === 'flex' ? 'none' : 'flex';
        }

        function checkout() {
            if (cart.length === 0) return alert('Cart empty.');
            if (confirm(`Pay ${totalRobux} Robux?`)) {
                window.location.href = 'https://discord.gg/eaekQmhNK3';
                cart = []; totalRobux = 0;
                document.getElementById('cartCount').textContent = 0;
                updateCartDisplay(); toggleCart();
            }
        }

        // Hook
        const origAdd = addToCart;
        addToCart = (n, i) => { origAdd(n, i); checkStockOut(); };
    </script>
</body>
</html>
